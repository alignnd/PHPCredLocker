/* ************************************************************
Author:  Ben Tasker - BenTasker.co.uk
Description: Admin Javascript functions for PHPCredLocker. Most 
  functions currently quick and dirty, will improve in future releases!

License: GNU GPL V2 -  See http://www.gnu.org/licenses/gpl-2.0.html

Repo: https://github.com/bentasker/PHPCredLocker/
---------------------------------------------------------------
Copyright (c) 2012 Ben Tasker

*/
function checkNewGroup(){var a=document.getElementById("frmName");if(a.value.length<=0){a.className+=" frmEntryMissed";return false}return true}function checkAddCredType(){var a=document.getElementById("frmName"),b=document.getElementById("ClickDiv").className.indexOf("EntropyGenerated");if(a.value.length<=0){a.className+=" frmEntryMissed";return false}if(b>=0){return true}alert("You must generate Entropy");return false}function validateUserAdd(){var a=0,c=document.getElementById("frmUsername"),b=document.getElementById("frmRName");if(c.value.length<=0){c.className="frmEntryMissed";a=1}if(b.value.length<=0){b.className="frmEntryMissed";a=1}if(!comparePwds()){a=1}if(a==1){alert("Please correct input errors and re-submit");return false}return true}function validateUserEdit(){var d=document.getElementById("frmUsername"),b=document.getElementById("frmRName"),c=document.getElementById("frmPass"),a=0;if(d.value.length<=0){d.className="frmEntryMissed";a=1}if(b.value.length<=0){b.className="frmEntryMissed";a=1}if(c.value.length>0){if(!comparePwds()){a=1}}if(a==1){alert("Please correct input errors and re-submit");return false}return true}function delGroup(h){var c,e,g,d,b=retKey(),f=document.getElementById("GroupDisp"+h),a=document.getElementById("NotificationArea");if(!confirm("Are you sure you want to delete this group (any credentials recorded against the group will be deleted)?")){return false}if(window.XMLHttpRequest){c=new XMLHttpRequest()}else{c=new ActiveXObject("Microsoft.XMLHTTP")}c.onreadystatechange=function(){if(c.readyState==4&&c.status==200){e=decryptAPIResp(c.responseText,b).split(getDivider());if(e[1]==2){return unknownAPICommand()}if(e[1]==0||e[2]==0){a.innerHTML+='<div class="alert alert-error">Failed to Delete</div>';return false}f.parentNode.removeChild(f);a.innerHTML+='<div class="alert alert-success">Group Deleted</div>'}};d=cryptReq("delGroup",b);c.open("POST","api.php",true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.send("option="+d+"&id="+h)}function delUser(h){var c,e,g,d,b=retKey(),f=document.getElementById("User"+h),a=document.getElementById("NotificationArea");if(!confirm("Are you sure you want to delete this user?")){return false}if(window.XMLHttpRequest){c=new XMLHttpRequest()}else{c=new ActiveXObject("Microsoft.XMLHTTP")}c.onreadystatechange=function(){if(c.readyState==4&&c.status==200){e=decryptAPIResp(c.responseText,b).split(getDivider());if(e[1]==2){return unknownAPICommand()}if(e[1]==0||e[2]==0){a.innerHTML+='<div class="alert alert-error">Failed to Delete</div>';return false}f.parentNode.removeChild(f);a.innerHTML+='<div class="alert alert-success">User Deleted</div>'}};d=cryptReq("delUser",b);c.open("POST","api.php",true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.send("option="+d+"&id="+h)}function delCredType(h){var c,e,g,d,b=retKey(),f=document.getElementById("CredType"+h),a=document.getElementById("NotificationArea");if(!confirm("Are you sure you want to delete this Credential Type (any associated credentials will be deleted)?")){return false}if(window.XMLHttpRequest){c=new XMLHttpRequest()}else{c=new ActiveXObject("Microsoft.XMLHTTP")}c.onreadystatechange=function(){if(c.readyState==4&&c.status==200){e=decryptAPIResp(c.responseText,b).split(getDivider());if(e[1]==2){return unknownAPICommand()}if(e[1]==0||e[2]==0){a.innerHTML+='<div class="alert alert-error">Failed to Delete</div>';return false}f.parentNode.removeChild(f);a.innerHTML+='<div class="alert alert-success">Credential Type Deleted</div>'}};d=cryptReq("delCredType",b);c.open("POST","api.php",true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.send("option="+d+"&id="+h)};